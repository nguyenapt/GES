<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>CDDBtoGSSSync</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>HBaseTablePrefix</name>
        <default_value>stage_</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>SqlDatabase</name>
        <default_value>GSS</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>SqlHost</name>
        <default_value>localhost</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>SqlPassword</name>
        <default_value>Niteco2018</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>SqlUsername</name>
        <default_value>niteco</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>ZooKeeper</name>
        <default_value>t-wn0-sust</default_value>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>100000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file>${Internal.Entry.Current.Directory}/connections.xml</shared_objects_file>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2019/04/14 18:33:07.157</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019/04/14 18:33:07.157</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>GES</name>
    <server>${SqlHost}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${SqlDatabase}</database>
    <port>1433</port>
    <username>${SqlUsername}</username>
    <password>${SqlPassword}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Sort companies by CddbId</from>
      <to>Union CDDB &amp; GSS Inside companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get GSS Inside companies IDs and ParkingTimestamp sorted by GssId</from>
      <to>Union CDDB &amp; GSS Inside companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Wait for GSS parking</from>
      <to>Upsert Inside GSS companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Compute ParkingTimestamp for GSS Inside exclusive companies</from>
      <to>Update parked GSS companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get companies details from CDDB</from>
      <to>Parse CddbId &amp; GssPu</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse CddbId &amp; GssPu</from>
      <to>Sort companies by CddbId</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get GSS coverage companies</from>
      <to>Sort companies by GssPu</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Copy rows</from>
      <to>Select CommonAndResearchEntityId</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort companies by GssPu</from>
      <to>Filter new coverages</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select CommonAndResearchEntityId</from>
      <to>Filter new coverages</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Copy rows</from>
      <to>Union rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter new coverages</from>
      <to>Drop join specific coverage fields</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Drop join specific coverage fields</from>
      <to>Union rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Union CDDB &amp; GSS Inside companies</from>
      <to>Add session timestamp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Union rows</from>
      <to>Compute ParkingTimestamp &amp; ResearchEntityId</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add session timestamp</from>
      <to>Filter common companies &amp; GSS research entities</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter common companies &amp; GSS research entities</from>
      <to>Copy rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter common companies &amp; GSS research entities</from>
      <to>Get GSS Inside exclusive companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get GSS Inside exclusive companies</from>
      <to>Compute ParkingTimestamp for GSS Inside exclusive companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get GSS Inside exclusive companies</from>
      <to>Get GSS coverage companies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Compute ParkingTimestamp &amp; ResearchEntityId</from>
      <to>Set empty strings where null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set empty strings where null</from>
      <to>Add non-nullable fields in GSS (required on insertion) not provided by CDDB</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add non-nullable fields in GSS (required on insertion) not provided by CDDB</from>
      <to>Wait for GSS parking</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Add non-nullable fields in GSS (required on insertion) not provided by CDDB</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>IsResearchEntityCandidate</name>
        <type>Boolean</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>false</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>Analyst</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
      </field>
      <field>
        <name>Reviewer</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>848</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Add session timestamp</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>Timestamp</name>
        <type>system date (fixed)</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Compute ParkingTimestamp &amp; ResearchEntityId</name>
    <type>Janino</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formula>
      <field_name>ComputedParkingTimestamp</field_name>
      <formula_string>GssPu &lt;= 19 &amp;&amp; GssPu >= 10 ? null : (ParkingTimestamp == null ? Timestamp : ParkingTimestamp)</formula_string>
      <value_type>Date</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <replace_field/>
    </formula>
    <formula>
      <field_name>ResearchEntityId</field_name>
      <formula_string>GssPu > 100 ? GssPu : null</formula_string>
      <value_type>Integer</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <replace_field/>
    </formula>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Compute ParkingTimestamp for GSS Inside exclusive companies</name>
    <type>Janino</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formula>
      <field_name>ComputedParkingTimestamp</field_name>
      <formula_string>ParkingTimestamp == null ? Timestamp : ParkingTimestamp</formula_string>
      <value_type>Date</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <replace_field/>
    </formula>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Copy rows</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Drop join specific coverage fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>CommonAndResearchEntityId</name>
      </remove>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Filter new coverages</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>Select CommonAndResearchEntityId</step1>
    <step2>Sort companies by GssPu</step2>
    <keys_1>
      <key>CommonAndResearchEntityId</key>
    </keys_1>
    <keys_2>
      <key>GssPu</key>
    </keys_2>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Filter common companies &amp; GSS research entities</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Copy rows</send_true_to>
    <send_false_to>Get GSS Inside exclusive companies</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>CddbId</leftvalue>
            <function>IS NOT NULL</function>
            <rightvalue>GssId</rightvalue>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>AND</operator>
            <leftvalue>GssId</leftvalue>
            <function>IS NOT NULL</function>
            <rightvalue/>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>OR</operator>
            <conditions>
              <condition>
                <negated>N</negated>
                <leftvalue>GssPu</leftvalue>
                <function>&lt;=</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>Integer</type>
                  <text>19</text>
                  <length>-1</length>
                  <precision>0</precision>
                  <isnull>N</isnull>
                  <mask>####0;-####0</mask>
                </value>
              </condition>
              <condition>
                <negated>N</negated>
                <operator>AND</operator>
                <leftvalue>GssPu</leftvalue>
                <function>&gt;=</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>Integer</type>
                  <text>10</text>
                  <length>-1</length>
                  <precision>0</precision>
                  <isnull>N</isnull>
                  <mask>####0;-####0</mask>
                </value>
              </condition>
            </conditions>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get GSS Inside exclusive companies</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Compute ParkingTimestamp for GSS Inside exclusive companies</send_true_to>
    <send_false_to>Get GSS coverage companies</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>CddbId</leftvalue>
        <function>IS NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get GSS Inside companies IDs and ParkingTimestamp sorted by GssId</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>GES</connection>
    <sql>SELECT Id AS GssId, IsParkedForResearchSince AS ParkingTimestamp FROM Companies ORDER BY Id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get GSS coverage companies</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to/>
    <send_false_to/>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <conditions>
              <condition>
                <negated>N</negated>
                <leftvalue>GssPu</leftvalue>
                <function>&gt;</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>Integer</type>
                  <text>99</text>
                  <length>-1</length>
                  <precision>0</precision>
                  <isnull>N</isnull>
                  <mask>####0;-####0</mask>
                </value>
              </condition>
            </conditions>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get companies details from CDDB</name>
    <type>HBaseInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cluster_name>HBase</cluster_name>
    <zookeeper_hosts>${ZooKeeper}</zookeeper_hosts>
    <zookeeper_port>2181</zookeeper_port>
    <source_table_name>${HBaseTablePrefix}external:corporateData</source_table_name>
    <output_fields>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>CddbId</alias>
        <family/>
        <column>CddbId</column>
        <key>Y</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>GssPu</alias>
        <family>pu</family>
        <column>pu_12</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>InternalId</alias>
        <family>ci</family>
        <column>companyInternalId</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>Description</alias>
        <family>ci</family>
        <column>businessDescription</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>WebSite</alias>
        <family>ci</family>
        <column>companyWebsite</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>Country</alias>
        <family>ci</family>
        <column>country</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>Isin</alias>
        <family>ci</family>
        <column>mainIsin</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>SubPeerGroup</alias>
        <family>ci</family>
        <column>subPeerGroup</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
      <field>
        <table_name>${HBaseTablePrefix}external:corporateData</table_name>
        <mapping_name>external:lightweightCorporateData</mapping_name>
        <alias>Name</alias>
        <family>ci</family>
        <column>companyNameSus</column>
        <key>N</key>
        <type>String</type>
        <format/>
      </field>
    </output_fields>
    <column_filters>
      <filter>
        <alias>Name</alias>
        <type>String</type>
        <comparison_opp>Regular expression</comparison_opp>
        <signed_comp>N</signed_comp>
        <constant>\w+</constant>
      </filter>
      <filter>
        <alias>InternalId</alias>
        <type>String</type>
        <comparison_opp>Regular expression</comparison_opp>
        <signed_comp>N</signed_comp>
        <constant>\w+</constant>
      </filter>
    </column_filters>
    <match_any_filter>N</match_any_filter>
    <mapping>
      <mapping_name>external:lightweightCorporateData</mapping_name>
      <table_name>stage_external:corporateData</table_name>
      <key>CddbId</key>
      <key_type>String</key_type>
      <mapped_columns>
        <mapped_column>
          <alias>GssPu</alias>
          <column_family>pu</column_family>
          <column_name>pu_12</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>InternalId</alias>
          <column_family>ci</column_family>
          <column_name>companyInternalId</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>Description</alias>
          <column_family>ci</column_family>
          <column_name>businessDescription</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>WebSite</alias>
          <column_family>ci</column_family>
          <column_name>companyWebsite</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>Country</alias>
          <column_family>ci</column_family>
          <column_name>country</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>Isin</alias>
          <column_family>ci</column_family>
          <column_name>mainIsin</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>SubPeerGroup</alias>
          <column_family>ci</column_family>
          <column_name>subPeerGroup</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>CddbId</alias>
          <column_family>null</column_family>
          <column_name>null</column_name>
          <type>String</type>
        </mapped_column>
        <mapped_column>
          <alias>Name</alias>
          <column_family>ci</column_family>
          <column_name>companyNameSus</column_name>
          <type>String</type>
        </mapped_column>
      </mapped_columns>
    </mapping>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parse CddbId &amp; GssPu</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>CddbId</name>
        <rename>CddbId</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>GssPu</name>
        <rename>GssPu</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select CommonAndResearchEntityId</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>Description</name>
      </remove>
      <remove>
        <name>ParkingTimestamp</name>
      </remove>
      <remove>
        <name>GssPu</name>
      </remove>
      <remove>
        <name>GssId</name>
      </remove>
      <remove>
        <name>InternalId</name>
      </remove>
      <remove>
        <name>Isin</name>
      </remove>
      <remove>
        <name>Name</name>
      </remove>
      <remove>
        <name>SubPeerGroup</name>
      </remove>
      <remove>
        <name>Timestamp</name>
      </remove>
      <remove>
        <name>WebSite</name>
      </remove>
      <remove>
        <name>Country</name>
      </remove>
      <meta>
        <name>CddbId</name>
        <rename>CommonAndResearchEntityId</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set empty strings where null</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>Description</name>
        <value/>
        <mask/>
        <set_empty_string>Y</set_empty_string>
      </field>
      <field>
        <name>WebSite</name>
        <value/>
        <mask/>
        <set_empty_string>Y</set_empty_string>
      </field>
      <field>
        <name>Country</name>
        <value/>
        <mask/>
        <set_empty_string>Y</set_empty_string>
      </field>
      <field>
        <name>Isin</name>
        <value/>
        <mask/>
        <set_empty_string>Y</set_empty_string>
      </field>
      <field>
        <name>SubPeerGroup</name>
        <value/>
        <mask/>
        <set_empty_string>Y</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>848</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort companies by CddbId</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>CddbId</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort companies by GssPu</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>GssPu</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Union CDDB &amp; GSS Inside companies</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>FULL OUTER</join_type>
    <step1>Sort companies by CddbId</step1>
    <step2>Get GSS Inside companies IDs and ParkingTimestamp sorted by GssId</step2>
    <keys_1>
      <key>CddbId</key>
    </keys_1>
    <keys_2>
      <key>GssId</key>
    </keys_2>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Union rows</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update parked GSS companies</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>GES</connection>
    <skip_lookup>Y</skip_lookup>
    <commit>5000</commit>
    <use_batch>Y</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>Companies</table>
      <key>
        <name>GssId</name>
        <field>Id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>IsParkedForResearchSince</name>
        <rename>ComputedParkingTimestamp</rename>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>848</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Upsert Inside GSS companies</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>GES</connection>
    <commit>5000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>dbo</schema>
      <table>Companies</table>
      <key>
        <name>CddbId</name>
        <field>Id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>InternalId</name>
        <rename>InternalId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>ResearchEntityId</name>
        <rename>ResearchEntityId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Name</name>
        <rename>Name</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Isin</name>
        <rename>Isin</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Description</name>
        <rename>Description</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Country</name>
        <rename>Country</rename>
        <update>Y</update>
      </value>
      <value>
        <name>SubPeerGroup</name>
        <rename>SubPeerGroup</rename>
        <update>Y</update>
      </value>
      <value>
        <name>WebSite</name>
        <rename>WebSite</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsParkedForResearchSince</name>
        <rename>ComputedParkingTimestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Analyst</name>
        <rename>Analyst</rename>
        <update>N</update>
      </value>
      <value>
        <name>Reviewer</name>
        <rename>Reviewer</rename>
        <update>N</update>
      </value>
      <value>
        <name>IsResearchEntityCandidate</name>
        <rename>IsResearchEntityCandidate</rename>
        <update>N</update>
      </value>
      <value>
        <name>Id</name>
        <rename>CddbId</rename>
        <update>N</update>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>336</xloc>
      <yloc>848</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Wait for GSS parking</name>
    <type>BlockUntilStepsFinish</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <steps>
      <step>
        <name>Update parked GSS companies</name>
        <CopyNr>0</CopyNr>
      </step>
    </steps>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>512</xloc>
      <yloc>848</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
